<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Jadwal Sholat Tangerang - Masjid Al‑Mujahidin</title>
<style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body, html { height: 100%; width: 100%; font-family: Arial, sans-serif; color: #fff; overflow: hidden; }

    /* Background slide */
    .bg-slide{
        position: fixed; top:0; left:0; width:100%; height:100%;
        background-size: cover; background-position: center; transition: background-image 1s ease;
        z-index: -2;
    }
    .overlay{ position: fixed; width:100%; height:100%; background: rgba(0,0,0,0.4); z-index:-1; }

    /* Header */
    .header { text-align:center; padding: 5px; background: rgba(0,0,0,0.2)}
    .header h1 { font-size: 1.8rem; text-shadow: 2px 2px 6px #000; }
    #datetime,#hijri { margin-top: 0px; font-size: 1.6rem; text-shadow: 1px 1px 6px #000;color:#bfa306 }
	#datetime{position: absolute; top: 3px; left: 10px;}

	.nm_jadwal {padding:5px;font-size: 1.8rem; text-shadow: 1px 1px 6px #000; background: rgba(255, 255, 255, 0.2);}
    /* Countdown kiri atas */
    #countdown {
        position: absolute; top: 10px; left: 10px;
        font-size: 1.3rem; padding: 8px 12px;
        background: rgba(0,0,0,0.5); border-radius: 8px;
        text-shadow: 1px 1px 3px #000;
    }

    /* Jadwal Sholat */
    .jadwal {
        position:absolute; bottom:35px; width:100%; background: rgba(0,0,0,0);
        display: flex; justify-content: space-around; padding: 15px; font-size:2rem;
        border-top-left-radius:20px; border-top-right-radius:20px;
    }
    .jadwal div {
        text-align:center; flex:1; margin:0 6px; padding:10px;
        transition:0.3s; border-radius: 10px;
    }
    .jadwal .highlight {
        background: rgba(242, 223, 7,0.2); transform: scale(1.15); font-weight:bold;
    }

   


</style>
</head>
<body>

<div class="bg-slide"></div>
<div class="overlay"></div>

<span id="datetime"></span>
<div class="header">
    <h1>Masjid Al‑Mujahidin</h1>
	<span id="hijri"></span>
</div>



<div class="jadwal" id="jadwalContainer">
    <div id="Fajr" style="background: rgba(9, 235 ,9,0.7)"></div>
    <div id="Dhuhr" style="background:rgba(228,98,240,0.7)"></div>
    <div id="Asr" style="background:rgba(242 ,142 ,2,0.7)"></div>
    <div id="Maghrib" style="background:rgba(9 ,235, 227,0.7)"></div>
    <div id="Isha" style="background:rgba(50 ,126 ,240,0.7)"></div>
</div>
<marquee id="marquee" style="position:absolute;bottom:0px;font-size:1.8em;background: rgba(0,0,0,0.8);padding:5px 0" behavior="scroll" direction="left" scrollamount="20">
  Pengumuman awal
</marquee>


<script>
   

let imgs   
	
// praytime.js - Prayer Times Calculator (v3.2)
// Copyright (c) 2007-2025 Hamid Zarrabi-Zadeh
// Source: https://praytimes.org
// License: MIT


//------------------------- User Interface ------------------------
/*
    method(method)          // set calculation method
    location(coordinates)   // set location
    timezone(timezone)      // set timezone
    utcOffset(number)       // set UTC offset in minutes or hours
    adjust(parameters)      // adjust calculation parameters
    tune(mins)              // tune times by given minutes
    format(format)          // options: 24h, 12h, 12H, x, X
    round(method)           // options: nearest, up, down, none
    getTimes(date)          // options: date, array, timestamp


//------------------------- Sample Usage --------------------------

    const praytime = new PrayTime('ISNA');
    praytime.location([43, -80]).timezone('America/Toronto');
    praytime.getTimes();

*/
//------------------------- PrayTime Class ------------------------

class PrayTime {

    constructor(method) {

        this.methods = {
            MWL: { fajr: 18, isha: 17 },
            ISNA: { fajr: 15, isha: 15 },
            Egypt: { fajr: 19.5, isha: 17.5 },
            Makkah: { fajr: 18.5, isha: '90 min' },
            Karachi: { fajr: 18, isha: 18 },
            Tehran: { fajr: 17.7, maghrib: 4.5, midnight: 'Jafari' },
            Jafari: { fajr: 16, maghrib: 4, midnight: 'Jafari' },
            France: { fajr: 12, isha: 12 },
            Russia: { fajr: 16, isha: 15 },
            Singapore: { fajr: 20, isha: 18 },
            defaults: { isha: 14, maghrib: '1 min', midnight: 'Standard' }
        };

        this.settings = {
            dhuhr: '0 min',
            asr: 'Standard',
            highLats: 'NightMiddle',
            tune: {},
            format: '24h',
            rounding: 'nearest',
            utcOffset: 'auto',
            timezone: Intl.DateTimeFormat().resolvedOptions().timeZone,
            location: [0, -(new Date()).getTimezoneOffset() / 4],
            iterations: 1
        };

        this.labels = [
            'Fajr', 'Sunrise', 'Dhuhr', 'Asr',
            'Sunset', 'Maghrib', 'Isha', 'Midnight'
        ];

        this.method(method || 'MWL');
    }


    //---------------------- Setters ------------------------

    // set calculation method
    method(method) {
        return this.set(this.methods.defaults).set(this.methods[method]);
    }

    // set calculating parameters
    adjust(params) {
        return this.set(params);
    }

    // set location
    location(location) {
        return this.set({ location });
    }

    // set timezone
    timezone(timezone) {
        return this.set({ timezone });
    }

    // set tuning minutes
    tune(tune) {
        return this.set({ tune });
    }

    // set rounding method
    round(rounding = 'nearest') {
        return this.set({ rounding });
    }

    // set time format
    format(format) {
        return this.set({ format });
    }

    // set settings parameters
    set(settings) {
        Object.assign(this.settings, settings);
        return this;
    }

    // set utc offset
    utcOffset(utcOffset = 'auto') {
        if (typeof utcOffset === 'number' && Math.abs(utcOffset) < 16)
            utcOffset *= 60;
        this.set({ timezone: 'UTC' });
        return this.set({ utcOffset });
    }


    //---------------------- Getters ------------------------

    // get prayer times
    times(date = 0) {
        if (typeof date === 'number')
            date = new Date((date < 1000) ? Date.now() + date * 864e5 : date);
        if (date.constructor === Date)
            date = [date.getFullYear(), date.getMonth() + 1, date.getDate()];
        this.utcTime = Date.UTC(date[0], date[1] - 1, date[2]);

        let times = this.computeTimes();
        this.formatTimes(times);
        return times;
    }

    // get prayer times (backward compatible)
    getTimes(date, location, timezone = 'auto', dst = 0, format = '24h') {
        if (!location) return this.times(date);
        const utcOffset = (timezone == 'auto') ? timezone : timezone + dst;
        this.location(location).utcOffset(utcOffset).format(format);
        return this.times(date);
    }


    //---------------------- Deprecated -------------------------

    // deprecated: set calculation method
    setMethod(method) {
        this.method(method);
    }


    //---------------------- Compute Times -----------------------

    // compute prayer times
    computeTimes() {
        let times = {
            fajr: 5,
            sunrise: 6,
            dhuhr: 12,
            asr: 13,
            sunset: 18,
            maghrib: 18,
            isha: 18,
            midnight: 24
        };

        for (let i = 0; i < this.settings.iterations; i++)
            times = this.processTimes(times);

        this.adjustHighLats(times);
        this.updateTimes(times);
        this.tuneTimes(times);
        this.convertTimes(times);
        return times;
    }

    // process prayer times
    processTimes(times) {
        const params = this.settings;
        const horizon = 0.833;

        return {
            fajr: this.angleTime(params.fajr, times.fajr, -1),
            sunrise: this.angleTime(horizon, times.sunrise, -1),
            dhuhr: this.midDay(times.dhuhr),
            asr: this.angleTime(this.asrAngle(params.asr, times.asr), times.asr),
            sunset: this.angleTime(horizon, times.sunset),
            maghrib: this.angleTime(params.maghrib, times.maghrib),
            isha: this.angleTime(params.isha, times.isha),
            midnight: this.midDay(times.midnight) + 12
        }
    }

    // update times
    updateTimes(times) {
        const params = this.settings;

        if (this.isMin(params.maghrib))
            times.maghrib = times.sunset + this.value(params.maghrib) / 60;
        if (this.isMin(params.isha))
            times.isha = times.maghrib + this.value(params.isha) / 60;
        if (params.midnight == 'Jafari') {
            const nextFajr = this.angleTime(params.fajr, 29, -1) + 24;
            times.midnight = (times.sunset + (this.adjusted ? times.fajr + 24 : nextFajr)) / 2;
        }
        times.dhuhr += this.value(params.dhuhr) / 60;
    }

    // tune times
    tuneTimes(times) {
        const mins = this.settings.tune
        for (let i in times)
            if (i in mins)
                times[i] += mins[i] / 60;
    }

    // convert times
    convertTimes(times) {
        const lng = this.settings.location[1];
        for (let i in times) {
            const time = times[i] - lng / 15;
            const timestamp = this.utcTime + Math.floor(time * 36e5);
            times[i] = this.roundTime(timestamp);
        }
    }

    // round time
    roundTime(timestamp) {
        const rounding = {
            up: 'ceil',
            down: 'floor',
            nearest: 'round'
        }[this.settings.rounding];
        if (!rounding)
            return timestamp;
        const OneMinute = 6e4;
        return Math[rounding](timestamp / OneMinute) * OneMinute;
    }


    //---------------------- Calculation Functions -----------------------

    // compute sun position
    sunPosition(time) {
        const lng = this.settings.location[1];
        const D = this.utcTime / 864e5 - 10957.5 + this.value(time) / 24 - lng / 360;

        const g = this.mod(357.529 + 0.98560028 * D, 360);
        const q = this.mod(280.459 + 0.98564736 * D, 360);
        const L = this.mod(q + 1.915 * this.sin(g) + 0.020 * this.sin(2 * g), 360);
        const e = 23.439 - 0.00000036 * D;
        const RA = this.mod(this.arctan2(this.cos(e) * this.sin(L), this.cos(L)) / 15, 24);

        return {
            declination: this.arcsin(this.sin(e) * this.sin(L)),
            equation: q / 15 - RA,
        }
    }

    // compute mid-day
    midDay(time) {
        const eqt = this.sunPosition(time).equation;
        const noon = this.mod(12 - eqt, 24);
        return noon;
    }

    // compute the time when sun reaches a specific angle below horizon
    angleTime(angle, time, direction = 1) {
        const lat = this.settings.location[0];
        const decl = this.sunPosition(time).declination;
        const numerator = -this.sin(angle) - this.sin(lat) * this.sin(decl);
        const diff = this.arccos(numerator / (this.cos(lat) * this.cos(decl))) / 15;
        return this.midDay(time) + diff * direction;
    }

    // compute asr angle
    asrAngle(asrParam, time) {
        const shadowFactor = { Standard: 1, Hanafi: 2 }[asrParam] || this.value(asrParam);
        const lat = this.settings.location[0];
        const decl = this.sunPosition(time).declination;
        return -this.arccot(shadowFactor + this.tan(Math.abs(lat - decl)));
    }


    //---------------------- Higher Latitudes -----------------------

    // adjust times for higher latitudes
    adjustHighLats(times) {
        const params = this.settings;
        if (params.highLats == 'None')
            return;

        this.adjusted = false;
        const night = 24 + times.sunrise - times.sunset;

        Object.assign(times, {
            fajr: this.adjustTime(times.fajr, times.sunrise, params.fajr, night, -1),
            isha: this.adjustTime(times.isha, times.sunset, params.isha, night),
            maghrib: this.adjustTime(times.maghrib, times.sunset, params.maghrib, night)
        });
    }

    // adjust time in higher latitudes
    adjustTime(time, base, angle, night, direction = 1) {
        const factors = {
            NightMiddle: 1 / 2,
            OneSeventh: 1 / 7,
            AngleBased: 1 / 60 * this.value(angle)
        };
        const portion = factors[this.settings.highLats] * night;
        const timeDiff = (time - base) * direction;
        if (isNaN(time) || timeDiff > portion) {
            time = base + portion * direction;
            this.adjusted = true;
        }
        return time;
    }


    //---------------------- Formatting Functions ---------------------

    // format times
    formatTimes(times) {
        for (let i in times)
            times[i] = this.formatTime(times[i]);
    }

    // format time
    formatTime(timestamp) {
        const format = this.settings.format;
        const InvalidTime = '-----';
        if (isNaN(timestamp))
            return InvalidTime;
        if (typeof format === 'function')
            return format(timestamp);
        if (format.toLowerCase() == 'x')
            return Math.floor(timestamp / ((format == 'X') ? 1000 : 1));
        return this.timeToString(timestamp, format);
    }

    // convert time to string
    timeToString(timestamp, format) {
        const utcOffset = this.settings.utcOffset;
        const date = new Date(timestamp + (utcOffset == 'auto' ? 0 : utcOffset) * 6e4);
        const str = date.toLocaleTimeString('en-US', {
            timeZone: this.settings.timezone,
            hour12: format == '24h' ? false : true,
            hour: format == '24h' ? '2-digit' : 'numeric',
            minute: '2-digit'
        });
        return format == '12H' ? str.replace(/ ?[AP]M/, '') : str;
    }


    //---------------------- Misc Functions -----------------------

    // convert string to number
    value(str) {
        return +String(str).split(/[^0-9.+-]/)[0];
    }

    // detect if input contains 'min'
    isMin(str) {
        return String(str).indexOf('min') != -1;
    }

    // positive modulo
    mod(a, b) {
        return ((a % b) + b) % b;
    }


    //--------------------- Degree-Based Trigonometry -----------------

    dtr = (d) => d * Math.PI / 180;
    rtd = (r) => r * 180 / Math.PI;

    sin = (d) => Math.sin(this.dtr(d));
    cos = (d) => Math.cos(this.dtr(d));
    tan = (d) => Math.tan(this.dtr(d));

    arcsin = (d) => this.rtd(Math.asin(d));
    arccos = (d) => this.rtd(Math.acos(d));
    arctan = (d) => this.rtd(Math.atan(d));

    arccot = (x) => this.rtd(Math.atan(1 / x));
    arctan2 = (y, x) => this.rtd(Math.atan2(y, x));
}


//------------------------- Export ------------------------

if (typeof module !== 'undefined' && module.exports) {
    module.exports = { PrayTime };
}


function updateJadwalSholat(){

	const PT = new PrayTime('ISNA');

	PT.adjust({
	  fajr: 20,      // Subuh
	  isha: 18,      // Isya
	  asr: 'Standard', // Syafi'i
	});

	PT.tune({
	  fajr: 2,      // Add 2 minutes to Fajr time
	  sunrise: 2,
	  dhuhr: 3,
	  asr: 2,
	  sunset: 2,
	  maghrib: 3,
	  isha: 2      // Subtract 1 minute from Isha time
	});

	PT.location([-6.178306,106.631889]).timezone('Asia/Jakarta');
	times=PT.getTimes();
	//console.log(times);
	document.getElementById("Fajr").innerHTML="<div class='nm_jadwal'>Shubuh</div><div>"+times.fajr+"</div>";
	document.getElementById("Dhuhr").innerHTML="<div class='nm_jadwal'>Dzuhur</div><div>"+times.dhuhr+"</div>";
	document.getElementById("Asr").innerHTML="<div class='nm_jadwal'>Ashar</div><div>"+times.asr+"</div>";
	document.getElementById("Maghrib").innerHTML="<div class='nm_jadwal'>Maghrib</div><div>"+times.maghrib+"</div>";
	document.getElementById("Isha").innerHTML="<div class='nm_jadwal'>Isya</div><div>"+times.isha+"</div>";
	
	

}


function updateDateTime() {
  const now = new Date();

  // === TANGGAL & JAM MASEHI ===
  const tanggalMasehi = now.toLocaleDateString("id-ID", {
    weekday: "long",
    day: "numeric",
    month: "long",
    year: "numeric"
  });

  const jam = now.toLocaleTimeString("id-ID", {
    hour: "2-digit",
    minute: "2-digit",
    second: "2-digit"
  });

  document.getElementById("datetime").innerHTML =
    `${tanggalMasehi}<br>${jam} WIB`;

  // === TANGGAL HIJRIYAH ===
  const hijri = new Intl.DateTimeFormat("id-ID-u-ca-islamic", {
    day: "numeric",
    month: "long",
    year: "numeric"
  }).format(now);

  document.getElementById("hijri").innerHTML =
    `${hijri}`;
}

// Update setiap detik
updateDateTime();
setInterval(updateDateTime, 1000);


updateJadwalSholat();
setInterval(updateJadwalSholat,60000); // tiap 1 menit





const GITHUB_TOKEN = "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";
const GITHUB_USER = "reportalmujahidin-legok";
const GITHUB_REPO = "tv";
const GITHUB_BRANCH = "main";

// ===== Background Slide =====
 
 imgs = new Array();
 
 /*imgs = [
	"https://images.unsplash.com/photo-1693590614566-1d3ea9ef32f7?q=80&w=1974&auto=format&fit=crop&ixlib=rb-4.1.0&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D",
	"https://images.unsplash.com/photo-1551041777-575d3855ca71?q=80&w=1170&auto=format&fit=crop&ixlib=rb-4.1.0&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D",
	"https://images.unsplash.com/photo-1464822759023-fed622ff2c3b?q=80&w=1170&auto=format&fit=crop&ixlib=rb-4.1.0&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D"
];*/



let idx = 0;
const bg = document.querySelector(".bg-slide");




async function fetchGithubFile() {
  const url = `https://api.github.com/repos/${GITHUB_USER}/${GITHUB_REPO}/contents/slide/slide.txt?ref=${GITHUB_BRANCH}`;

  const headers = {};
  if (GITHUB_TOKEN) headers["Authorization"] = `Bearer ${GITHUB_TOKEN}`;

  try {
    const res = await fetch(url, { headers });
    if (!res.ok) throw new Error(res.status + " " + res.statusText);
    const data = await res.json();

    if (data.encoding === "base64") {
      // Decode base64
      const text = atob(data.content.replace(/\s/g, ""));
      const jobj= JSON.parse(text);
	  
	  const slides= jobj[0][0]["slides"];
	  const kas_info = jobj[1][0]["kas"];
	  const khatib = jobj[2][0]["khatib"];
	  const runText = jobj[3][0]["runText"];
	  
	  slides.forEach(function(item, index) {
		  imgs.push(item);
	  });
	  
	  if(runText!= ""){
		const el = document.getElementById("marquee");
		
		 el.innerHTML = runText;

  
	  }
	  
	 
	 nextBG();
	 setInterval(nextBG, 8000);

	  
	  console.log(runText);
	  
    }

  } catch (err) {
     console.error(err);
  }
}

// Jalankan
fetchGithubFile();



function nextBG() {
	bg.style.backgroundImage = `url(${imgs[idx]})`;
	idx = (idx + 1) % imgs.length;
}

	
	
	

</script>

</body>
</html>
